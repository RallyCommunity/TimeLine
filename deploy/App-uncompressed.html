<!DOCTYPE html>
<html>
<head>
    <title>TimeLine</title>

    <script type="text/javascript" src="/apps/2.0/sdk-debug.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define('CustomApp', {
    extend: 'Rally.app.App',
    componentCls: 'app',

    inheritableStatics: {
        ErrorColour: 'tomato',
        WarnColour:  'orangered',
        PassColour:  'lightgreen',
        DoneColour:  'silver',
        ToDoColour:  'lightblue',
        HdrColour:   'lightgray',
        DataError:   'red',
        DaysPerMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
        TreeBoxWidth: 200,
        StandardBarHeight: 30,
        MileStoneBoxColour: 'red'
    },

    items: [
        {
            xtype: 'container',
            layout: 'hbox',
            items: [
                {
                    xtype: 'container',
                    flex: 1,
                    layout: 'hbox',
                    items: [
                        {
                            xtype: 'rallyportfolioitemtypecombobox',
                            margin: 10,
                            id: 'piType'
                        },
                        {
                            xtype: 'rallydatefield',
                            margin: 10,
                            format: 'D d M Y',
                            id: 'StartDate',
                            stateful: true,
                            fieldLabel: 'Start Date',
                            value: Ext.Date.subtract( new Date(), Ext.Date.DAY, 90) // 90 days of previous information
                        },
                        {
                            xtype: 'rallydatefield',
                            margin: 10,
                            fieldLabel: 'End Date',
                            format: 'D d M Y',
                            stateful: true,
                            id: 'EndDate',
                            value: new Date()
                        }
                    ]
                },
                {
                    xtype: 'container',
                    layout: 'hbox',
                    margin: 10,
                    items: [
                        {
                            xtype: 'rallybuttonslider',
                            labelText: 'Zoom',
                            id: 'zoomSlider',
                            stateful: true,
                            value: 10

                        }
                    ]
                }
            ]
        }
    ],

    getSettingsFields: function() {

        var returnVal = [{
                xtype: 'rallycheckboxfield',
                name: 'percentageType',
                value: true,
                fieldLabel: 'Use story points for percentages:',
                stateful: true,
                stateId: 'percent-' + Ext.id(),
                labelAlign: 'right',
                labelWidth: 200

            }
        ];

        return returnVal;

    },

    //Define a pixel factor for the zoom
    zoomLevel: 1,

    _resetTreeBox: function(app) {
        var tb = Ext.getCmp('treeBox');
        app._destroyBars(tb.id);

        tb.add( {
            xtype: 'timeLineBar',
            html: 'Calendar Month:',
            colour: CustomApp.HdrColour,
            width: '100%',
            margin: '0 0 10 0'
        });

    },

    _destroyBars: function(boxTitle) {

        var box = Ext.getCmp(boxTitle);
        if (box) { box.removeAll(); }
    },

     _resizeAllBars: function() {
        this._destroyBars('monthBox');
        this._destroyBars('releaseBox');
        this._destroyBars('iterationBox');
        this._drawMonthBars();
        this._releaseRender();
        this._destroyBars('lineBox');
        this._redrawTimeLines(this, Ext.getCmp('piType').getRecord().get('TypePath'));
    },


    _iterationRender: function() {
    },

    _releaseRender: function() {

        var app = this;

        var relStore = Ext.create('Rally.data.wsapi.Store', {
            model: 'release',
            autoLoad: true,
            context: {
                project: Rally.environment.getContext().getProjectRef(),
                projectScopeUp: false,
                projectScopeDown: false
            },
            sorters: [{
                property: 'ReleaseDate',
                direction: 'ASC'
            }],
            listeners: {
                load: function(store, data, success) {
                    //Create a list of items removing gaps between releases (shouldn't be any apart from the day of handover)

                    var releaseBox = Ext.getCmp('releaseBox');
                    var boxes = [];

                    if (data.length > 0){
                        var tb = Ext.getCmp('treeBox');
                        tb.insert(0, {
                            xtype: 'timeLineBar',
                            width: '100%',
                            html : 'Program Increment:',
                            colour : CustomApp.HdrColour
                        });
                    }

                    _.each(data, function(release) {

                        var thisStart = Ext.Date.clearTime(release.get('ReleaseStartDate'));
                        var thisEnd = Ext.Date.clearTime(Ext.Date.add(release.get('ReleaseDate'), Ext.Date.HOUR, 1)); //Takes you up to the end of the day

                        if ((lastBox = boxes[boxes.length-1])) {
                            //Check the date of the last one and if needed, add a spacer
                            if (lastBox.end != thisStart) {
                                var spacerBox = {
                                    'width': (Ext.Date.getElapsed( lastBox.end, thisStart)* stats.pixelsPerDay)/(24 * 3600 * 1000),
                                    'start': lastBox.end,
                                    'leftMargin': 0,
                                    'end': thisStart,
                                    'colour': CustomApp.ToDoColour,
                                    'title': ''
                                };
                                boxes.push(spacerBox);
                            }
                        }
                        var box = {
                            'width': (Ext.Date.getElapsed( thisEnd, thisStart)* stats.pixelsPerDay)/(24 * 3600 * 1000),
                            'leftMargin': 0,
                            'start': thisStart,
                            'end': thisEnd,
                            'colour': CustomApp.HdrColour,
                            'title': release.get('Name')
                        };
                        boxes.push(box);
                    });

                    //Now truncate the list of boxes depending on the display time

                    _.each(boxes, function(box) {
                        if (!((box.end < stats.start) || (box.start > stats.end))) {    //Somewhere in view
                            if (box.start < stats.start) {
                                box.start = stats.start;
                                if (box.start > box.end) {
                                    box.width = 0;
                                } else {
                                    box.width = (Ext.Date.getElapsed( box.end, box.start)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                                }
                            }
                            if (box.end > stats.end) {
                                box.end = stats.end;
                                if ( box.end < box.start) {
                                    box.width = 0;
                                } else {
                                    box.width = (Ext.Date.getElapsed( box.end, box.start)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                                }
                            }

                            var theBar = app._createBar(box);
                            theBar.addCls('mnthBox');
                            theBar.addCls('tltBox');

                            releaseBox.add(theBar);
                        }
                    });
                }
            }
        });
    },

//    _createBar: function( record ) {
//
//        var margin = '0 0 0 ' + record.leftMargin;
//
//        var bar =  Ext.create('Rally.app.CustomTimeLineBar', {
//            id: 'TimeLineBar-' + Ext.id(),
//            margin: margin,
//            html: record.title,
//            width: record.width,
//            height: record.height || CustomApp.StandardBarHeight,
//            align: 'center'
//        });
//        bar.setStyle({'backgroundColor' : record.colour});
//
//        return bar;
//    },
//

    launch: function() {

        var app = this;

        // Get the zoom slider and  add some handlers
        var slider = Ext.getCmp('zoomSlider');
        var lb = slider.getLeftButton();
        var rb = slider.getRightButton();
        var sl = slider.getSlider();

        rb.on('click', function() {
            app.zoomLevel += 1;
            if (app.zoomLevel > 10) { app.zoomLevel = 10; }
            sl.setValue( app.zoomLevel * 10 );
            app._resizeAllBars();
        });

        lb.on('click', function() {
            app.zoomLevel -= 1;
            if (app.zoomLevel <= 0) { app.zoomLevel = 1; }
            sl.setValue( app.zoomLevel * 10 );
            app._resizeAllBars();
        });

        sl.on('changecomplete', function( slider, value, that) {
            app.zoomLevel = Math.trunc(value/10);
            app._resizeAllBars();
        });

        // Add handlers for date changes

        Ext.getCmp('StartDate').on('select', app._resizeAllBars, app);
        Ext.getCmp('EndDate').on('select', app._resizeAllBars, app);

        //Define a box to the left for the item tree and a box to the right that has the lines in


        var timeLineBox = Ext.create('Ext.container.Container', {
                layout: 'hbox',
                items: [
                    {
                        xtype: 'container',
                        id: 'treeBox',
                        width: this.self.TreeBoxWidth - 4, //Margin
                        margin: '0 0 0 0', //Space for milestone box
                        autoScroll: false
                    },
                    {
                        xtype: 'container',
                        id: 'scrollBox',
                        layout: 'vbox',
                        items: [
                            {
                                xtype: 'container',
                                id: 'releaseBox',
                                layout: 'hbox'
                            },
                            {
                                xtype: 'container',
                                id: 'iteration',
                                layout: 'hbox'
                            },
                            {
                                xtype: 'container',
                                id: 'monthBox',
                                layout: 'hbox'
                            },
                            {
                                xtype: 'container',
                                autoSize: true,
                                id: 'lineBox'
                            }
                        ],
                        flex: 1,
                        autoScroll: true
                    }
                ],
            listeners: {
                render: this._headerRendered, //Once rendered we have the layout dimensions
                scope: app
            }
        });

        this.add(timeLineBox);

        //Whilst that is happening, fetch the roots (not tree!)

        //TODO

        var pitype = Ext.getCmp('piType');

        pitype.on('select', function() { app._redrawTimeLines(app, this.getRecord().get('TypePath')); });

        if (pitype.rendered){
            this._redrawTimeLines(this, Ext.getCmp('piType').getRecord().get('TypePath'));
        }

    },

    onTimeBoxScopeChange: function(newScope) {
        this._redrawTimeLines(this, Ext.getCmp('piType').getRecord().get('TypePath'));
    },

    // Modify the title box popup if the data is invalid
    _dataCheckItem: function(app, box, item) {

    },

    _addToday: function(app) {
        var msbox = Ext.getCmp('milestoneBox');
        var linebox = Ext.getCmp('lineBox');

        //Create a thing to add to month box

        var margin = '0 0 0 ' + ((Ext.Date.getElapsed( stats.start, new Date())* stats.pixelsPerDay)/(24 * 3600 * 1000) - 4);
        todayIcon = Ext.create('Ext.container.Container', {
            height: '10px',
            width: '10px',
            style: {
                backgroundColor: CustomApp.MileStoneBoxColour
            },
            margin: margin
        });
        Ext.create('Ext.tip.ToolTip', {
            target: todayIcon,
            html: 'Today: ' + Ext.Date.format(new Date(), 'D M Y')
        });

        todayIcon.addCls('todayIcon');
        msbox.add(todayIcon);

        //Create a thing to add to lineBox
        todayLine = Ext.create('Ext.container.Container', {
            height: linebox.getHeight(),
            width: '1px',
            border: 1,
            style: {
                borderColor: '#000000',
                borderStyle: 'solid',
                backgroundColor: '#000000'
            },
            margin: '0 0 0 ' + (Ext.Date.getElapsed( stats.start, new Date())* stats.pixelsPerDay)/(24 * 3600 * 1000)
        });
        msbox.add(todayLine);
    },

    _redrawTimeLines: function(app, type ) {

        var filters = [];
        var timeboxScope = app.getContext().getTimeboxScope();
        if(timeboxScope) {
            filters.push(timeboxScope.getQueryFilter());
        }

        var itemStore = Ext.create('Rally.data.wsapi.Store', {
            model: type,
            autoLoad: true,
            filters: filters,
            sorters: [{
                property: 'rank',
                direction: 'ASC'
            }],
            listeners: {
                load: function(store, data, success) {

                    var timeLineBox = Ext.getCmp('lineBox');
                    var treeBox = Ext.getCmp('treeBox');
                    app._destroyBars(timeLineBox.id);
                    app._destroyBars(Ext.getCmp('releaseBox'));
                    app._destroyBars(Ext.getCmp('iterationBox'));
                    app._releaseRender();
                    app._iterationRender();
                    app._resetTreeBox(app);

                    app._addMilestoneBox(app);
                    _.each(data, function(item) {

                        tlbox = app._createTimeLineForItem(app, item);
                        timeLineBox.add(tlbox);

                        ttbox = app._createTitleBoxForItem(app, item);
                        app._dataCheckItem(app, ttbox, item);
                        treeBox.add(ttbox);

                    });
                    app._addToday(app);
                }
            }
        });
    },

    _createTitleBoxForItem: function(app, item) {
        var titleRec = {};
        titleRec.colour = CustomApp.HdrColour;
        titleRec.leftMargin = 0;
        titleRec.width = '100%';
        titleRec.title = item.get('FormattedID') + ': ' + item.get('Name');
        var box = app._createBar(titleRec);
        box.addCls('tltBox');

        return box;
    },

    _createTimeLineForItem: function(app, item) {

        var today = new Date(); // Seize the day...

        //We are creating two bars within the space of one, so reduce the height
        //Create a container to hold the bars first

        var box = Ext.create('Ext.container.Container', {
            id: 'timeLineBox-' + item.get('FormattedID')
        });

        box.addCls('tlBox');
        box.height = CustomApp.StandardBarHeight;

        // Create bar for PlannedStart and PlannedEnd. TODO: store these records for later manipulation
        var pRecord = {};
        pRecord.colour = CustomApp.HdrColour;
        pRecord.title = '';
        pRecord.width = 0;
        pRecord.height = Math.floor(CustomApp.StandardBarHeight/2);
        pRecord.leftMargin = 0;

        var plannedStart = null;
        var plannedEnd = null;
        var startBetween = null;
        var endBetween = null;

        //Are there incomplete data
        if (!(item.get('PlannedStartDate') && item.get('PlannedEndDate'))) {
            pRecord.colour = CustomApp.DataError;
        } else {
            plannedStart = new Date(item.get('PlannedStartDate'));
            plannedEnd = new Date(item.get('PlannedEndDate'));

            startBetween = Ext.Date.between( plannedStart, stats.start, stats.end);
            endBetween = Ext.Date.between( plannedEnd, stats.start, stats.end);

            //If there is no start date in the item, the timeline will go back forever!

            if ( !startBetween && endBetween ){
                pRecord.leftMargin = 0;
                pRecord.width = (Ext.Date.getElapsed( stats.start, plannedEnd)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }

            //If there is no end date in the item, the timeline will go on forever!

            else if ( startBetween && !endBetween ) {
                pRecord.leftMargin = (Ext.Date.getElapsed( stats.start, plannedStart)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                pRecord.width = (Ext.Date.getElapsed( plannedStart, stats.end)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }

            else if ( startBetween && endBetween) {
                pRecord.leftMargin = (Ext.Date.getElapsed( stats.start, plannedStart)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                pRecord.width = (Ext.Date.getElapsed( plannedStart, plannedEnd)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }
        }
        var plannedBar = app._createBar(pRecord);
        plannedBar.addCls('planBar');
        box.add(plannedBar);

        // Create bar for ActualStart and ActualEnd
        var aRecord = {};
        var percentComplete = 0;

        if ( app.getSetting('percentageType')) {
            percentComplete = Math.floor(item.get('PercentDoneByStoryPlanEstimate') * 100);
        } else {
            percentComplete = Math.floor(item.get('PercentDoneByStoryCount') * 100);
        }
        aRecord.colour = CustomApp.PassColour;
        aRecord.height = Math.floor(CustomApp.StandardBarHeight/2);
        aRecord.leftMargin = 0;
        aRecord.width = 0;
        aRecord.title = '';

        var actualStart = new Date(item.get('ActualStartDate'));
        var actualEnd = new Date(item.get('ActualEndDate'));

        //Let's see what colour it should be

        if ((item.get('ActualStartDate') && item.get('ActualEndDate'))) {
            aRecord.colour = CustomApp.DoneColour;
            aRecord.title = percentComplete + '%';
            aRecord.leftMargin = (Ext.Date.getElapsed( stats.start, actualStart)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            aRecord.width = (Ext.Date.getElapsed( actualStart, actualEnd)* stats.pixelsPerDay)/(24 * 3600 * 1000);

        } else {

            if (item.get('ActualStartDate')) {
                aRecord.title = percentComplete + '%';
                colourStart = item.get('ActualStartDate');
            } else if (item.get('PlannedEndDate')) {
                colourStart = item.get('PlannedStartDate');
            } else {
                colourStart = today;
            }

            if (item.get('ActualEndDate')){
                colourEnd = item.get('ActualEndDate');
            }
            else if (item.get('PlannedEndDate')) {
                colourEnd = item.get('PlannedEndDate');
            }
            else {
                colourEnd = today;
            }

            var totalElapsed = colourEnd - colourStart;

            //User params??
            var acceptanceDelay = totalElapsed * 0.2;
            var warningDelay    = totalElapsed * 0.2;

            colourStartDate = new Date(colourStart);
            colourEndDate = new Date(colourEnd);

            yellowXStart = Ext.Date.add(colourStartDate, Ext.Date.MILLI, acceptanceDelay);
            redXStart = Ext.Date.add(colourStartDate, Ext.Date.MILLI, acceptanceDelay + warningDelay);

            yellowSlope = 100 / (colourEnd - yellowXStart);
            redSlope = 100 / (colourEnd - redXStart);

            redThreshold =redSlope * (today - redXStart);
            yellowThreshold =yellowSlope * (today - yellowXStart);

            if (percentComplete < redThreshold ) {
                aRecord.colour = CustomApp.ErrorColour;
            }

            if (percentComplete < yellowThreshold ) {
                aRecord.colour = CustomApp.WarnColour;
            }

            if (today > colourEnd) {
                if (percentComplete >= 100) {
                    aRecord.colour = CustomApp.DoneColour;
                }
                else {
                    aRecord.colour = CustomApp.ErrorColour;
                }
            }

            //Now calculate the sizes and position

            startBetween = Ext.Date.between( actualStart, stats.start, stats.end);
            endBetween = Ext.Date.between( actualEnd, stats.start, stats.end);

           //If there is no start date in the item, the timeline will go back forever!
            if ( !startBetween && endBetween ){
                aRecord.leftMargin = 0;
                aRecord.width = (Ext.Date.getElapsed( stats.start, actualEnd?actualEnd:today)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }

            //If there is no end date in the item, the timeline will go on forever!

            else if ( startBetween && !endBetween ) {
                aRecord.leftMargin = (Ext.Date.getElapsed( stats.start, actualStart)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                aRecord.width = (Ext.Date.getElapsed( actualStart, item.get('ActualEndDate')?stats.end:today)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }

            else if ( startBetween && endBetween) {
                aRecord.leftMargin = (Ext.Date.getElapsed( stats.start, actualStart)* stats.pixelsPerDay)/(24 * 3600 * 1000);
                aRecord.width = (Ext.Date.getElapsed( actualStart, item.get('ActualEndDate')?actualEnd:today)* stats.pixelsPerDay)/(24 * 3600 * 1000);
            }

        }
        var actualBar = app._createBar(aRecord);
        actualBar.addCls('actualBar');
        box.add(actualBar);

        return box;
    },

//        Ext.util.Observable.capture( pitype, function(event) { console.log( 'pitype:', arguments);});


//gb = Ext.getBody()
//gb.dom.getElementsByClassName('rally-app')

    //Only call in the context of the rally-app to get the dimensions
    _calcTimeStats: function() {
        //We want to show a minimum of 1 pixel per day. We will start off looking at the window size. If that's OK, we draw to
        // fill the box. If we have got below 1 pixel per day, we need to use a wider box and then scroll bars.
        // The zoom level control may increase the minimum in pixel increments or 10%, whichever is the smaller.

        stats = {};

        // We want to show the whole month that it starts in and ends in
        stats.start =  new Date(Ext.Date.getFirstDateOfMonth(Ext.getCmp('StartDate').value));
        stats.end =  new Date(Ext.Date.getLastDateOfMonth(Ext.getCmp('EndDate').value));

        stats.daysDuration = (stats.end - stats.start)/ (24 * 3600 * 1000);
        stats.daysDuration = (stats.daysDuration > 31) ? stats.daysDuration : 31 ;   //One more than the biggest month to make sure we show correctly
        var pixelsPerDay = (Ext.getBody().getWidth() - this.self.TreeBoxWidth) / (stats.daysDuration > 0 ? stats.daysDuration : 1) * this.zoomLevel;
        stats.pixelsPerDay = pixelsPerDay > 1 ? pixelsPerDay : 1;

        return stats;

    },

    _addMilestoneBox: function(app) {

        //We need to force a long box all across the lines box to house the milestone icons
        var lineBox = Ext.getCmp('lineBox');

        var milestoneBox = Ext.create('Ext.container.Container', {
            width: stats.daysDuration * stats.pixelsPerDay,
            height: '10px',
            id: 'milestoneBox',
            style: {
                backgroundColor: CustomApp.MileStoneBoxColour
            }
        });

        lineBox.add(milestoneBox);
    },

    _drawMonthBars: function() {

        var record = {};

        var monthBox = Ext.getCmp('monthBox');

        this._calcTimeStats();

        monthNum = stats.start.getMonth();
        var lDate = stats.start;
        var lDays = 0;

        while (lDate <= stats.end) {
            record.title = Ext.Date.format(lDate, 'M Y');
            record.colour = CustomApp.HdrColour;
            record.width = (this.self.DaysPerMonth[monthNum] * stats.pixelsPerDay);

            var mnth = this._createBar(record);
            mnth.addCls('mnthBox');
            monthBox.add(mnth);
            lDate = Ext.Date.add(lDate, Ext.Date.MONTH, 1);

            monthNum += 1;
            if (monthNum > 11 ) { monthNum = 0;}
        }
    },

    _createBar: function( record ) {

        var margin = '0 0 0 ' + record.leftMargin;

        var bar =  Ext.create('Rally.app.CustomTimeLineBar', {
            id: 'TimeLineBar-' + Ext.id(),
            margin: margin,
            html: record.title,
            width: record.width,
            height: record.height || CustomApp.StandardBarHeight,
            align: 'center'
        });
        bar.setStyle({'backgroundColor' : record.colour});

        return bar;
    },

    _headerRendered: function() {

        //Now draw in some month bars
        this._drawMonthBars();
        this._resetTreeBox(this);
    }
});

Ext.define('Rally.app.CustomTimeLineBar', {
    extend: 'Ext.Component',
    alias: 'widget.timeLineBar',

    constructor: function(config) {
        this.mergeConfig(config);       //Style is not merged, just over-written! Use setStyle instead.
        this.callParent(arguments);
    },

    config: {
        autoSize: true,
        viewBox: false,
        draggable: false,
        height: CustomApp.StandardBarHeight,
        style: {
            font: '12px Helvetica, sans-serif',
            backgroundColor: CustomApp.HdrColour,
            textAlign: 'center'
        }

    },

//    renderTpl: this.getContentTpl(),
//
    getContentTpl: function() {
        var me = this;

        return Ext.create('Ext.XTemplate',
            '<tpl if="this.canDrag()"><div class="icon drag"></div></tpl>',
            '{[this.getActionsGear()]}',
            '<div class="textContent ellipses">{[this.getFormattedId()]} {[this.getSeparator()]}{Name}</div>',
            '<div class="rightSide">',
            '</div>',
            {
                canDrag: function() {
                    return me.getCanDrag();
                },
                getActionsGear: function() {
                    return me._buildActionsGearHtml();
                },
                getFormattedId: function() {
                    var record = me.getRecord();
                    return record.getField('FormattedID') ? Rally.ui.renderer.RendererFactory.renderRecordField(record, 'FormattedID') : '';
                },
                getSeparator: function() {
                    return this.getFormattedId() ? '- ' : '';
                }
            }
        );
    }
});



            Rally.launchApp('CustomApp', {
                name:"TimeLine",
	            parentRepos:""
            });

        });
    </script>



    <style type="text/css">
        .app {
  /* Add app styles here */
}
.tlBox {
  border-bottom: 1px solid #bbbbbb;
  height: 30px;
}
.planBar {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAABZSURBVDgRpczLDQAgCERBaMz+u0Ix0cQfLLgXwuENiUihxFo3x4metB4d68aD3h3QLoTcgBDyAmDEAiDEA1wEAUwEBZ5IBLgiUeBAMsCCZIGJ/AAd+QVaXyqZmUp5jZKhMgAAAABJRU5ErkJggg==');
  background-repeat: repeat-x;
  margin-top: 5px;
}
.actualBar {
  height: 10px;
  padding-bottom: 5px;
}
.tltBox {
  border-bottom: 1px solid #FFFFFF;
}
.mnthBox {
  border-left: 1px solid #999999;
}
.todayIcon {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAA6SURBVBgZY2RgYPgPxAQBE0EVUAWMUJqQqYwkmwgyGJepYFvJMhGbqTA/MBBtItTTKBTIrRjuJdpEANf+BgyegZ+UAAAAAElFTkSuQmCC');
}
.milestoneIcon {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAABLSURBVBgZjY7RCgAgCAOz///napEyR4h7ktsxtHUyGpnq2IvyJMJxgW+wELVAmVjnRzixiIUqV6xWvYtFB7zKLEQIXPCNzhQA/rIBthYoAU7mS/IAAAAASUVORK5CYII=');
}

    </style>
</head>
<body>
</body>
</html>
